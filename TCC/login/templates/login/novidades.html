{% extends "login/layout.html" %}
{% load static %}
{% block head %}
<link rel="stylesheet" href="{% static 'login/css/novidades.css' %}"></link>
{% endblock %}

{% block body %}



<div class="container-fluid ">
    <div class="row">
        <div class="novidades-container col-12 col-sm-5">
        </div>
        <form method="POST" class="col" id="editar-dados-usuario">
            {% csrf_token %}
            {% for field in form %}
            
                {% for error in field.errors %}
                <div class="error-messages text-danger">
                    {{ error }}
                </div> 
                {%endfor%}
                <div class="form-group">
                    {{field.label_tag}}
                    {{field}}
                </div>
            {% endfor %}
            <div class="row ">
                <div class="col d-flex justify-content-end p-3">
                    <button type="submit" class="btn btn-primary">Adicionar</button>
                </div>
            </div>
        </form>
    </div>
</div>

<script>
    const novidadesContainer = document.querySelector('.novidades-container');
    const novidadesString = (("{{novidades}}")).replace(/&(l|g|quo|&#x27)t;/g, function(a,b){
                return {
                    l   : '<',
                    g   : '>',
                    quo : '"',
                }[b];
            }).replaceAll("'", '"').replaceAll("&#x27;", '"').replaceAll('\n', "\\n");
    
    var novidadesHTML = ""
    const novidades = JSON.parse(novidadesString)
    novidades.forEach(novidade => {
        novidadesHTML += `<div class="novidade">
                                <div class="titulo text-center">${novidade.titulo}</div>
                                <div class="body">${novidade.conteudo}</div>
                                <hr>
                          </div>`
    });

    novidadesContainer.innerHTML = novidadesHTML
 
</script>

{% endblock %}